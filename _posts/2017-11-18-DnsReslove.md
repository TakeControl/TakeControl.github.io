---
layout:     post
title:      "DNS解析过程"

date:       2017-11-18 23:00:00
author:     "ShiYu"
catalog: true
tags:
    - Web
---

# DNS解析

DNS解析主要步骤如下图：
![dns解析过程](http://139.224.133.147/dist/images/dns_resloving.png)

上图展示了DNS解析的3到10步，在真正向lDns发起请求之前还有两步，DNS解析步骤如下：

1. 浏览器检测缓存中是否有对应的解析过的ip地址，如果缓存中有，则解析过程结束
2. 如果浏览器缓存中没有，浏览器会查找操作系统缓存中是否有这个域名对应的解析结果，如果有，则解析过程结束
3. 如果操作系统缓存中也没有，则会向local dns服务器发起解析请求，这个服务器的性能都会很好，并会缓存结果，缓存时间受域名失效时间控制，80%域名解析服务在此就会结束，在缓存中找到该域名对应的解析结果后，解析过程结束
4. 如果LDNS中也没有，则会直接到Root Server域名服务器请求解析
5. 根域名服务器返回给本地服务器一个所查询的主域名服务器（gTLD）地址。gTLD是国际顶级域名服务器，如com、cn、org等
6. 本地域名服务器再向上一步返回的gTLD服务器发送请求
7. gTLD服务器查找并返回此域名对应的Name Server域名服务器地址，这个Name Server通常就是你注册的域名服务器
8. 向Name Server发起域名解析请求，Name Server会查询存储的域名和IP的映射关系表，连同一个TTL值返回给本地域名服务器
9. 本地域名服务器缓存这个域名和ip的对应关系，缓存时间由TTL值控制。
10. 把解析结果返回给用户，用户根据TTL值缓存到本地系统中，域名解析到此结束。
